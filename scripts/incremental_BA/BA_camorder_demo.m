cath = mmread('cathedral_cconn.mtx');
veni = mmread('venice_cconn.mtx');
% load matrices

[v_order_DFS, v_order_BFS, v_order_BFSpq, c_order_DFS, c_order_BFS, c_order_BFSpq] = orders();
%v_order_DFS =   [0 865 5 520 452 208 288 129 233 59 521 361 719 626 760 815 150 92 780 842 278 66 47 611 111 561 613 69 377 548 15 6 200 46 851 53 19 67 151 840 149 410 406 198 213 286 108 616 486 113 133 318 41 37 255 432 306 328 73 373 523 715 623 28 30 193 608 434 276 42 396 31 243 729 242 536 764 176 177 29 110 696 704 712 466 22 784 467 553 192 772 487 544 535 649 482 573 308 708 87 236 237 159 161 230 231 761 232 331 785 187 564 388 226 392 519 209 227 382 238 565 428 706 171 474 599 248 265 267 270 367 656 504 505 128 767 531 175 383 633 700 791 844 545 12 137 397 775 371 774 843 240 140 681 852 346 295 314 433 138 513 326 186 422 631 75 106 495 360 646 225 832 444 621 74 622 272 418 566 160 430 777 841 727 826 492 419 490 489 864 695 850 558 339 577 183 264 514 127 838 805 542 540 825 537 721 568 835 836 757 598 647 648 754 856 672 765 819 749 753 854 480 628 49 657 855 508 509 431 472 386 645 4 762 853 694 593 703 671 8 549 11 824 684 592 625 571 297 572 609 668 76 707 789 88 184 173 247 578 39 23 24 38 481 552 244 289 831 307 316 423 424 425 412 413 517 341 516 464 773 210 787 814 55 56 57 142 141 85 124 839 131 325 849 427 50 446 381 627 510 512 228 524 199 583 541 245 823 246 493 539 586 639 637 494 822 632 711 454 372 453 713 779 798 682 828 702 747 18 693 119 121 309 591 717 718 416 436 447 685 802 271 82 13 735 736 739 590 709 728 188 130 766 60 458 867 9 44 132 327 354 222 25 722 528 473 324 636 488 675 1 239 27 182 16 500 448 280 139 214 398 409 340 465 471 475 250 455 429 10 94 811 162 221 305 801 281 282 293 294 330 806 411 97 368 600 462 638 329 415 654 456 655 857 77 734 114 194 2 166 168 449 100 95 96 148 352 353 585 101 365 629 302 498 154 745 32 33 610 810 285 618 595 617 644 812 771 689 697 547 716 195 52 256 165 167 54 303 343 321 756 375 118 90 115 117 116 807 869 290 837 217 215 216 732 407 496 497 603 563 379 575 605 724 468 463 380 640 641 469 683 781 782 866 7 670 274 275 269 91 145 144 143 189 190 550 405 686 359 401 643 312 70 744 258 313 615 320 560 158 366 678 607 667 669 205 273 758 522 395 559 257 759 797 800 783 319 860 543 26 260 261 666 259 665 311 820 580 677 477 701 720 152 43 733 223 224 283 61 555 763 284 287 442 443 511 680 870 817 525 529 534 606 612 650 20 35 89 279 36 109 83 207 506 21 768 63 156 64 357 690 752 201 102 263 385 155 351 663 748 804 507 197 334 252 362 725 746 604 664 84 298 662 674 795 808 743 581 705 136 196 14 157 51 651 62 79 652 461 251 163 169 821 254 660 333 335 350 374 296 253 384 770 731 624 376 414 426 439 451 546 602 661 342 792 827 107 794 179 304 698 323 337 502 594 673 676 358 518 450 485 589 526 530 532 356 562 58 103 122 470 569 576 554 710 751 796 809 211 642 658 234 584 3 220 181 219 218 459 833 317 834 291 45 72 81 322 355 408 692 80 538 99 363 653 364 460 476 180 691 98 404 78 185 776 755 845 848 112 393 338 104 172 714 147 277 241 266 301 483 588 533 387 619 123 125 527 126 249 723 740 741 262 438 437 389 394 174 587 620 788 421 420 687 688 778 345 699 551 292 105 191 34 17 863 71 344 349 614 153 597 818 601 813 370 369 803 858 378 742 769 178 570 567 635 206 204 146 203 336 659 65 68 478 484 134 299 332 557 440 479 48 582 417 596 93 202 491 268 86 399 400 435 310 229 347 40 574 120 164 315 348 579 634 750 786 135 390 391 726 679 799 170 235 847 738 300 212 457 846 515 790 861 862 556 402 859 441 793 816 829 868 403 499 501 503 445 830 630 730 737] + 1;
%v_order_BFS =   [0 865 5 520 630 730 452 737 208 288 445 830 129 233 59 521 719 760 815 829 868 361 626 150 441 793 816 403 499 501 503 92 278 780 842 66 111 548 556 859 47 611 561 613 15 93 202 268 310 347 348 579 634 750 786 799 861 862 402 69 6 200 479 491 86 399 435 229 40 120 164 315 135 390 170 300 515 790 377 46 53 65 134 299 332 440 48 417 596 400 574 391 726 235 847 212 851 19 67 149 198 213 286 525 534 606 612 650 659 68 557 582 679 738 457 846 151 410 108 113 133 152 223 283 284 287 442 511 680 817 529 20 378 742 769 478 840 406 616 318 580 677 701 720 43 733 224 61 555 763 443 870 35 178 570 484 486 41 319 543 477 89 279 601 813 858 567 635 37 87 159 265 267 271 274 395 559 759 800 860 26 260 261 311 820 36 105 191 344 349 614 818 370 803 206 255 432 236 161 171 248 270 367 504 505 545 571 609 668 707 789 802 82 590 709 275 257 797 783 666 109 136 551 34 71 153 597 369 204 336 306 308 708 237 230 706 474 599 656 128 531 633 700 791 844 12 137 140 346 508 625 297 572 76 88 173 416 436 447 685 13 735 728 766 867 269 273 259 83 207 506 705 196 211 234 338 421 688 778 292 17 146 203 328 482 573 231 232 331 785 767 175 383 397 775 843 681 852 295 314 433 558 577 749 854 509 592 184 247 578 702 747 736 739 188 60 458 9 44 132 327 354 781 866 91 145 320 758 665 21 63 156 201 263 385 507 743 14 107 179 304 323 337 358 450 485 526 554 710 751 796 809 642 658 584 104 147 241 266 301 483 533 619 788 420 345 699 863 73 373 623 761 187 428 371 774 240 138 419 490 695 850 339 183 264 514 540 598 647 672 765 819 753 480 628 855 431 593 703 39 55 56 85 124 131 325 427 510 512 524 583 632 711 779 798 828 18 119 309 591 717 130 222 324 636 675 683 782 7 670 144 312 560 522 768 64 357 690 752 102 155 197 604 664 581 157 163 169 254 333 335 350 374 376 414 426 439 451 546 602 661 792 827 794 698 502 594 673 676 518 589 530 532 562 3 45 72 81 322 355 692 755 845 848 172 714 277 588 387 123 174 587 620 687 523 28 772 564 513 489 864 127 838 825 648 856 49 657 472 853 671 824 23 24 38 244 289 307 316 464 773 814 57 142 839 849 50 446 228 199 541 822 454 713 682 693 121 718 25 722 488 1 27 77 114 194 463 469 143 401 643 70 744 158 678 351 663 748 804 334 746 84 298 662 51 251 821 660 296 384 770 342 356 58 103 122 470 569 576 220 408 80 99 180 691 112 393 125 126 249 262 389 715 30 31 176 192 487 535 649 388 565 326 422 631 805 537 721 757 754 386 645 762 694 8 549 684 481 552 831 423 517 210 141 381 627 245 372 453 528 239 182 448 734 2 166 380 640 189 359 258 313 366 607 667 669 252 362 725 674 808 651 253 731 181 219 459 833 538 363 364 98 527 723 438 394 193 434 243 536 764 177 467 544 226 392 519 186 75 542 568 835 4 11 424 425 341 516 787 823 473 16 280 455 168 195 303 343 375 603 724 641 190 550 686 615 205 795 62 79 652 624 218 317 834 653 460 476 404 740 741 437 608 276 396 729 29 466 784 553 209 227 238 106 225 444 621 622 826 836 412 246 500 139 250 429 449 498 547 716 52 165 321 118 807 869 563 605 468 405 461 291 78 185 776 42 242 110 696 704 22 382 495 646 832 74 272 418 566 777 841 492 413 493 539 639 214 340 465 471 475 10 94 162 221 281 329 415 654 655 857 100 302 154 285 689 697 256 167 756 90 115 117 290 407 379 575 712 360 160 727 586 637 398 409 811 305 801 282 293 294 330 411 600 638 456 95 101 365 629 745 618 644 771 54 116 837 496 430 494 806 97 462 96 32 610 810 595 617 812 217 732 497 368 148 352 33 215 353 216 585] + 1;
%%v_order_BFSpq = [0 865 5 520 630 730 452 737 208 288 445 830 129 233 59 521 719 760 815 829 868 361 626 150 441 793 816 403 499 501 503 92 278 780 842 66 111 548 556 859 47 611 561 613 15 93 202 268 310 347 348 579 634 750 786 799 861 862 402 69 6 200 479 491 86 399 435 229 40 120 164 315 135 390 170 300 515 790 377 46 53 65 134 299 332 440 48 417 596 400 574 391 726 235 847 212 851 19 67 149 198 213 286 525 534 606 612 650 659 68 557 582 679 738 457 846 151 410 108 113 133 152 223 283 284 287 442 511 680 817 529 20 378 742 769 478 840 406 616 318 580 677 701 720 43 733 224 61 555 763 443 870 35 178 570 484 486 41 319 543 477 89 279 601 813 858 567 635 37 87 159 265 267 271 274 395 559 759 800 860 26 260 261 311 820 36 105 191 344 349 614 818 370 803 206 255 432 236 161 171 248 270 367 504 505 545 571 609 668 707 789 802 82 590 709 275 257 797 783 666 109 136 551 34 71 153 597 369 204 336 306 308 708 237 230 706 474 599 656 128 531 633 700 791 844 12 137 140 346 508 625 297 572 76 88 173 416 436 447 685 13 735 728 766 867 269 273 259 83 207 506 705 196 211 234 338 421 688 778 292 17 146 203 328 482 573 231 232 331 785 767 175 383 397 775 843 681 852 295 314 433 558 577 749 854 509 592 184 247 578 702 747 736 739 188 60 458 9 44 132 327 354 781 866 91 145 320 758 665 21 63 156 201 263 385 507 743 14 107 179 304 323 337 358 450 485 526 554 710 751 796 809 642 658 584 104 147 241 266 301 483 533 619 788 420 345 699 863 73 373 623 761 187 428 371 774 240 138 419 490 695 850 339 183 264 514 540 598 647 672 765 819 753 480 628 855 431 593 703 39 55 56 85 124 131 325 427 510 512 524 583 632 711 779 798 828 18 119 309 591 717 130 222 324 636 675 683 782 7 670 144 312 560 522 768 64 357 690 752 102 155 197 604 664 581 157 163 169 254 333 335 350 374 376 414 426 439 451 546 602 661 792 827 794 698 502 594 673 676 518 589 530 532 562 3 45 72 81 322 355 692 755 845 848 172 714 277 588 387 123 174 587 620 687 523 28 772 564 513 489 864 127 838 825 648 856 49 657 472 853 671 824 23 24 38 244 289 307 316 464 773 814 57 142 839 849 50 446 228 199 541 822 454 713 682 693 121 718 25 722 488 1 27 77 114 194 463 469 143 401 643 70 744 158 678 351 663 748 804 334 746 84 298 662 51 251 821 660 296 384 770 342 356 58 103 122 470 569 576 220 408 80 99 180 691 112 393 125 126 249 262 389 715 30 31 176 192 487 535 649 388 565 326 422 631 805 537 721 757 754 386 645 762 694 8 549 684 481 552 831 423 517 210 141 381 627 245 372 453 528 239 182 448 734 2 166 380 640 189 359 258 313 366 607 667 669 252 362 725 674 808 651 253 731 181 219 459 833 538 363 364 98 527 723 438 394 193 434 243 536 764 177 467 544 226 392 519 186 75 542 568 835 4 11 424 425 341 516 787 823 473 16 280 455 168 195 303 343 375 603 724 641 190 550 686 615 205 795 62 79 652 624 218 317 834 653 460 476 404 740 741 437 608 276 396 729 29 466 784 553 209 227 238 106 225 444 621 622 826 836 412 246 500 139 250 429 449 498 547 716 52 165 321 118 807 869 563 605 468 405 461 291 78 185 776 42 242 110 696 704 22 382 495 646 832 74 272 418 566 777 841 492 413 493 539 639 214 340 465 471 475 10 94 162 221 281 329 415 654 655 857 100 302 154 285 689 697 256 167 756 90 115 117 290 407 379 575 712 360 160 727 586 637 398 409 811 305 801 282 293 294 330 411 600 638 456 95 101 365 629 745 618 644 771 54 116 837 496 430 494 806 97 462 96 32 610 810 595 617 812 217 732 497 368 148 352 33 215 353 216 585];
%v_order_BFSpq = [0 865 5 520 452 208 288 129 233 59 445 521 361 630 719 626 730 737 815 150 92 278 66 47 111 441 548 15 6 93 200 46 53 19 65 67 68 134 149 151 198 202 213 268 86 286 108 113 133 152 43 223 224 283 61 284 287 299 310 229 318 41 37 87 159 161 171 230 231 232 236 237 248 255 265 267 270 271 82 13 274 275 269 91 145 144 143 189 190 273 312 70 319 320 331 332 347 40 120 164 315 348 359 367 395 399 400 401 410 406 432 306 308 328 73 373 435 440 442 443 474 478 479 48 417 482 484 491 504 505 128 511 523 525 529 531 175 383 534 543 26 260 261 311 545 12 137 140 346 295 314 397 433 138 419 490 489 508 509 431 472 386 513 326 186 422 550 405 555 556 402 557 558 339 559 257 560 158 366 561 571 297 572 573 574 577 183 264 514 127 540 579 580 582 590 592 593 596 598 599 606 609 611 612 613 69 377 616 486 623 28 30 31 176 177 29 110 192 193 243 434 276 42 396 466 22 467 536 553 608 625 631 75 106 225 444 495 360 621 74 622 272 418 566 160 430 633 634 643 645 4 646 647 648 650 20 35 89 279 36 105 109 83 136 191 34 17 71 196 14 107 157 51 163 169 179 207 211 234 251 254 304 323 333 335 337 338 104 147 172 241 266 277 301 344 349 350 358 374 296 253 376 378 384 414 421 420 426 439 450 451 483 485 502 506 21 63 156 64 201 102 263 357 385 155 351 507 197 334 252 362 518 526 530 532 356 533 387 546 551 292 554 562 58 103 122 470 569 576 584 3 45 72 81 220 181 219 218 322 355 408 459 588 589 594 601 602 604 614 153 597 619 123 125 126 174 249 262 389 394 438 437 527 587 620 642 651 62 79 652 461 656 658 659 660 661 342 663 664 84 298 662 666 259 665 668 76 672 673 674 676 677 477 678 607 667 669 205 680 681 686 687 688 690 692 80 99 180 363 364 460 476 538 653 691 98 404 78 185 695 696 698 700 701 703 671 8 549 11 704 705 706 707 708 709 710 712 714 715 720 723 725 728 188 130 729 242 733 735 736 739 740 741 742 743 581 744 258 313 615 746 748 749 750 751 752 753 754 755 758 522 759 761 762 763 764 765 766 60 458 767 768 769 178 570 567 635 206 204 146 203 336 770 731 624 772 487 535 544 649 775 371 774 776 777 778 345 699 780 784 785 187 428 564 388 226 392 519 209 227 238 382 565 786 135 390 391 726 679 788 789 88 173 184 247 416 436 447 578 39 23 24 38 55 56 57 85 124 131 142 141 244 289 307 316 325 423 424 425 412 413 427 50 446 381 464 481 510 512 228 517 341 516 524 199 552 583 541 245 627 632 685 702 711 454 372 453 713 747 18 119 121 309 591 693 717 718 773 210 779 787 791 792 793 794 795 796 797 798 682 799 170 235 300 212 457 515 790 800 783 802 804 808 809 813 370 369 803 814 816 817 818 819 820 821 822 823 246 493 539 586 639 637 494 824 684 825 537 721 568 757 826 492 827 828 829 830 760 831 832 833 317 834 291 835 836 838 805 542 839 840 841 727 843 240 844 845 846 847 738 848 112 393 849 850 851 852 853 694 854 480 628 49 657 855 856 858 859 860 861 862 863 864 867 9 44 132 327 354 222 25 324 636 488 675 1 27 77 114 182 16 194 2 166 168 195 52 165 167 54 239 256 303 343 321 375 118 90 115 117 116 448 280 139 214 250 340 398 409 449 100 95 96 101 148 302 352 353 365 455 429 10 94 162 221 281 282 293 294 305 329 330 411 97 368 415 463 380 465 469 471 475 498 154 285 500 547 585 600 462 603 563 379 575 605 618 595 617 629 638 640 641 644 654 456 655 683 689 697 716 722 528 473 724 468 734 745 32 33 610 756 771 781 782 801 806 807 810 811 812 857 866 7 670 868 403 499 501 503 842 870 869 290 407 837 496 217 215 216 732 497] + 1;
%c_order_DFS =   [0 1 2 3 4 5 9 10 8 7 13 14 15 11 20 19 12 24 25 26 88 89 90 91 27 30 28 29 31 34 35 38 37 36 39 40 41 42 43 44 46 47 48 57 71 72 58 59 60 61 74 63 62 56 66 68 67 70 69 76 77 78 79 80 81 75 82 65 64 73 50 51 52 55 53 54 83 45 49 32 33 86 84 87 85 16 17 18 22 21 23 6] + 1;
%c_order_BFS =   [0 1 2 3 4 5 6 9 10 16 8 11 12 17 18 7 20 24 22 13 14 19 25 27 21 15 26 91 30 84 85 23 88 28 29 31 32 86 87 89 34 35 33 90 38 37 39 36 40 41 42 43 45 44 46 50 83 49 47 58 51 53 48 59 73 52 54 57 71 60 63 64 55 72 61 74 62 65 56 66 68 75 67 69 82 70 76 77 78 79 80 81] + 1;
%%c_order_BFSpq = [0 1 2 3 4 5 6 9 10 16 8 11 12 17 18 7 20 24 22 13 14 19 25 27 21 15 26 91 30 84 85 23 88 28 29 31 32 86 87 89 34 35 33 90 38 37 39 36 40 41 42 43 45 44 46 50 83 49 47 58 51 53 48 59 73 52 54 57 71 60 63 64 55 72 61 74 62 65 56 66 68 75 67 69 82 70 76 77 78 79 80 81];
%c_order_BFSpq = [0 1 2 3 4 5 6 9 10 11 12 16 8 7 13 14 15 17 18 20 19 24 22 21 23 25 27 26 84 85 87 88 89 90 91 30 28 29 31 32 33 35 38 37 36 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 57 58 59 60 61 63 62 56 64 65 66 68 67 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 86 34] + 1;
% permutations generated by the shell scripts

palette = jet;
palette(1, :) = [1 1 1]; % want zeros "transparent"
% prepare palette

s = 512; % subplot size

% --- cathedral

hFig = figure(1);
set(hFig, 'Position', [200 200 (s * 4) s]);

hSfig = subplot(1, 4, 1); % subfigure in newer matlabs
imagesc(cath);
colormap(palette);
title(hSfig, 'camera adjacency in natural order');
axis image;

hSfig = subplot(1, 4, 2); % subfigure in newer matlabs
imagesc(cath(c_order_DFS, c_order_DFS));
colormap(palette);
title(hSfig, 'DFS spanning tree');
axis image;

hSfig = subplot(1, 4, 3); % subfigure in newer matlabs
imagesc(cath(c_order_BFS, c_order_BFS));
colormap(palette);
title(hSfig, 'BFS spanning tree');
axis image;

hSfig = subplot(1, 4, 4); % subfigure in newer matlabs
imagesc(cath(c_order_BFSpq, c_order_BFSpq));
colormap(palette);
title(hSfig, 'BFS / priority queue spanning tree');
axis image;

% --- venice

hFig = figure(2);
set(hFig, 'Position', [200 200 (s * 4) s]);

hSfig = subplot(1, 4, 1); % subfigure in newer matlabs
imagesc(veni);
colormap(palette);
title(hSfig, 'camera adjacency in natural order');
axis image;

hSfig = subplot(1, 4, 2); % subfigure in newer matlabs
imagesc(veni(v_order_DFS, v_order_DFS));
colormap(palette);
title(hSfig, 'DFS spanning tree');
axis image;

hSfig = subplot(1, 4, 3); % subfigure in newer matlabs
imagesc(veni(v_order_BFS, v_order_BFS));
colormap(palette);
title(hSfig, 'BFS spanning tree');
axis image;

hSfig = subplot(1, 4, 4); % subfigure in newer matlabs
imagesc(veni(v_order_BFSpq, v_order_BFSpq));
colormap(palette);
title(hSfig, 'BFS / priority queue spanning tree');
axis image;
